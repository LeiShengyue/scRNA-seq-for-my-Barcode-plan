library(devtools)
# install_github("chrisamiller/fishplot")
library(fishplot)
library(RColorBrewer)

### SET PATH
setwd(file.path("/Users/leishengyue/Desktop/data/论文数据/BCD/fish plot"))

### SET SEQUENCING TIME POINTS
timepoints=c(20,40,60,80,100) # EVEN TIMEPOINTS TO HARMONIZE WITH OTHER PANEL FIGURES
timepoints=c(0,6,12,29,52) 

### SET PARENTS
parents = c(0,1,1,2,2,3,3,3,3,3,6,5,5,4,6,9) 
parents = c(0,1,1,3,3,2,5,5,4) 
parents = c(0,1,1,2,3,2,5,5,4) 

parents = c(0,1,1,1,1,1,1,2,2,8,8,9,3,3,3,3,5,4,5,5,6,6,6,6,12,12,10,13,15,13,17,18,17,22,21,23,23) 
parents = c(0,1,1,1,1,1,1,2,3,4,5,6,8,9,10,11,12,13,14,15,16,17) 

parents = c(0,1,1,1,1,1,1) 

frac.table = matrix(
  c(88,  0, 0,  0,  0,  0,  0,  0, 0, 0, 0, 0, 0, 0, 0, 0, 
    100, 44, 44, 1,  1,  1,  1,  1, 1, 1, 0, 0, 0, 0, 0, 0, 
    100, 50, 50, 14, 10, 6.7, 6.5, 5.5, 2.5, 2, 1, 1, 1, 1, 1, 1,   
    100, 50, 50, 28.7, 21.3, 13.7, 13, 11, 7, 5.3, 4.5, 5.5, 4.5, 14, 2, 3.5, 
    100, 50, 50, 28.7, 21.3, 13.7, 0, 0, 7, 0, 9.45, 11.4, 9.9, 28.7, 4.25, 7),
  ncol=length(timepoints))

frac.table = matrix(
  c(100, 1, 1, 0, 2, 1, 50, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,
    100, 4, 4, 1, 8, 4, 79, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 
    100, 10, 4, 1, 4, 4, 75, 10, 4, 1, 4, 1, 1, 1, 1, 1, 1, 0, 0, 0, 0, 0, 
   100, 16, 16, 1.5, 14, 14, 38, 15, 14, 1.5, 14, 14, 4.2, 5.3, 1.5, 13.5, 13.5, 1, 1, 1, 1, 1, 
    100, 25, 15, 10, 5, 5, 40, 24, 15, 9, 5, 4.6, 24, 15, 9, 5, 4.6, 24, 15, 9, 5, 4.6),
ncol=length(timepoints))

frac.table <- matrix(
  c(100, 0.01, 0.01, 0.01, 0.01, 0.01, 50,
    100, 0.04, 0.04, 0.04, 0.08, 0.04, 95,
    100, 0.1,  0.04, 0.04, 0.04, 0.04, 75,
    100, 16,   16,   1.5,  14,   14,   38,
    100, 25,   15,   10,   5,    5,    40),
ncol=length(timepoints))


frac.table = matrix(
  c(88, 0.01, 0.01, 0.01, 0.01, 0.01, 30, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    100, 0.04, 0.04, 0.04, 0.04, 0.04, 99.8, 0.01, 0.01, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    100, 0.1, 0.04, 0.04, 0.04, 0.04, 97, 0.05, 0.05, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    100, 16, 16, 3, 10.6, 13.5, 40, 5, 10.2, 4.2, 0.8, 10.2, 9.5, 2.45, 2, 1.7, 6.9, 2.7, 1.7, 2, 4, 6.3, 1.15, 2, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0.01, 0, 
    100, 25, 16, 3, 20, 24, 12, 2.2, 22, 2.2, 0, 22, 12, 0, 3.2, 0, 20, 2.8, 0, 0, 5, 5.1, 12, 0, 18.8, 2.6, 2.2, 8.6, 3.2, 2.6, 8.5, 2.8, 10.6, 5.1, 5, 7.5, 4.2),
  ncol=5
)

frac.table = matrix(
  c(
    88, 0.1, 0.1, 0.1, 0.1, 0.1, 70, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    100, 0.4, 0.4, 0.4, 0.4, 0.4, 95, 0.1, 0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    100, 1, 0.4, 0.4, 0.4, 0.4, 90, 0.5, 0.5, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 
    100, 16, 16, 3, 10.6, 13.5, 40, 5, 10.2, 4.2, 0.8, 10.2, 9.5, 2.45, 2, 1.7, 6.9, 2.7, 1.7, 2, 4, 6.3, 1.15, 2, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0.1, 0, 
    100, 25, 16, 3, 20, 24, 12, 2.2, 22, 2.2, 0, 22, 12, 0, 3.2, 0, 20, 2.8, 0, 0, 5, 5.1, 12, 0, 18.8, 2.6, 2.2, 8.6, 3.2, 2.6, 8.5, 2.8, 10.6, 5.1, 5, 7.5, 4.2
  ),
  ncol=5
)


frac.table = matrix(
  c(88,  0, 0, 0, 0,  0, 0,  0,0, #0
    100, 44, 44,  0,  0, 0, 0,  0,0, #6
    100, 50, 50,  1, 1, 1,  0,  0,0,  #12
    100, 33.4, 66.5, 28, 66.5, 5.4, 1, 1,1, #29
    100, 9,  91, 9, 91, 0,  80, 11, 9),#52
  ncol=length(timepoints))

frac.table = matrix(
  c(88,  0, 0, 0, 0,  0, 0,  0,0, #0
    100, 44, 44,  0,  0, 0, 0,  0,0, #6
    100, 50, 50,  1, 1, 1,  0,  0,0,  #12
    100, 3, 97, 27, 70,  3, 1, 1,1, #29
    100, 0,  100, 29,  70, 0,  61, 8.7, 29),#52
  ncol=length(timepoints))

frac.table = matrix(
  c(88,  1, 1,   0,  0,   0,  0,  0,#0
    100, 50, 50,  1,  1,   0,  0,  0,#6
    100, 0,  98,  78, 17,  1,  1,  0, #12
    100, 0,  100, 68, 30,  40, 30, 1,#29
    100, 0,  100, 0,  100, 0,  100, 97),#52
  ncol=length(timepoints))

### CREATE FISH OBJECT
fish = createFishObject(frac.table,parents,timepoints=timepoints)
fish = layoutClones(fish)
# 创建 37 个颜色（使用 RColorBrewer 的颜色调色板或 base R 的 rainbow）
# library(RColorBrewer)
# # 使用 rainbow 生成 37 个颜色（你也可以换成其它调色板）
# clone_colors <- rainbow(37)
# # 设置颜色给 fish 对象
# fish <- setCol(fish, clone_colors)
clone.colors <- colorRampPalette(brewer.pal(7, "Set3"))(nrow(frac.table))  # 柔和配色
fish <- setCol(fish, clone.colors)
fishPlot(fish, shape="spline", bg.type="solid", bg.col="#FFFFFF")

# 设置颜色
fish <- setCol(fish, c(
  "#819A91", "#A7C1A8", "#D1D8BE", "#EEEFE0", "#FFF2E0",
  "#C0C9EE", "#d0dbd7"
  #  "#A2AADB"
#   , "#898AC4", "#999999"
# #   , "#555879",
# #   "#98A1BC", "#DED3C4", "#1B3C53", "#456882", "#D2C1B6", "#B2CD9C"
))


fishPlot(fish,shape="spline",bg.type="solid", bg.col="#FFFFFF",
title.btm="MPS1i", cex.title=0.5, vlines=c(0,6,12,29,52),vlab=c("day 0","day 6","day 12","day 29","day 52"))
